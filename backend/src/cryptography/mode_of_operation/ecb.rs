use crate::cryptography::aes::{aes_decrypt, aes_encrypt, AESKey};
use crate::cryptography::mode_of_operation::ModeOfOperation;

/// The `Electronic Code Block` mode encodes each block separately from one another.
/// This is easy, but gives up some information about the plaintext.
/// More information: https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_codebook_(ECB)
pub struct ECB;

impl ModeOfOperation for ECB {
    fn encrypt<K: AESKey>(&self, key: &K, plaintext: &[u128]) -> Vec<u128> {
        plaintext.iter().map(|plain_block| aes_encrypt(*plain_block, key)).collect()
    }

    fn decrypt<K: AESKey>(&self, key: &K, ciphertext: &[u128]) -> Vec<u128> {
        ciphertext.iter().map(|cipher_block| aes_decrypt(*cipher_block, key)).collect()
    }
}

#[cfg(test)]
mod tests {
    use crate::cryptography::aes::*;
    use crate::cryptography::mode_of_operation::tests::*;
    use super::*;

    #[test]
    fn ecb_encrypt_128() {
        test_encrypt::<AESKey128, ECB>(
            "a31c06bd463e3923bc1aadbde48b1697",
            "6c080717373b819a068f32b7a6b38b6b38729647cfde01c2ce28b26c57472737f5c3561a1761185bd8589a43ce0bba75891ff9ec60148d4bd4a09ee2dc5c9331b4110ba93ac54afc14da3bdd19614774a2d55d295e5a35ab44b3efaea5129ba22b88ba3e29766145fdeca3b08e38af53d7c4c60e3ad208ce5066441036e9f191",
            "dc1177433adf18cb1804c1080d6915ef442ed72e895cfd1d76ab37f197d0263613a97bf03c2c6d9fad2323e488aebd30009a1c245195925b3c89c74f5d50157f0c6201f95f576411f8338de86c49f61ee6ae95e440eb6c030e44bc3dcb5fa37614ff7d81a24ecee64ff8a87f7b043e52a369c4aae7ce26268e8b0423db95664d",
            ECB
        );
        test_encrypt::<AESKey128, ECB>(
            "e0b75036a77f65e2eaa4752443233fbe",
            "8f8943bf956de595665c38ffff23827e17c10cdc1c27a028caae6c9810626198ff778740f88ddcf102aeb81daee289c044c4a4571c4b6f287400f4b8e0b843f880c32d81e91bdea04cd7a3819b32275fc3298af4c7ec87eb0099527d041ced5ce0fcd4ce4e3d0e3de091f21415bb7cd011fac288c42020a879f28c2a4387df9b",
            "70112dceedd381de71dd7abf8dd582d14ad156bcf1925c4fed97a2350cd30a069c158b833a1b387fae0b008b3bfa75fb85cba280cb038e2fa5fbc144834c9e4ed8a18e125355e4747cccb81cc26389fd68b7e6e2584fb777ee462f1f90cce0e25a8cba4dc021d8967360ffaeed317ada0443782eacf49ffaf9ac832dc07e235c",
            ECB
        );
        test_encrypt::<AESKey128, ECB>(
            "6cf636ed8ac1bab033b64f66feaba65f",
            "70e684731e3f39105605968d3a96380112b5a10f3a11e708dc5412833c47ab7c368a21b9efe19293793ec879ce68301818a86e5a6c6977ddba0daca7fba5190f67ba56ccdc1b3f31308972236c2e47763fdfec1371cedcdb8c190ca6ff8ad603f817edc0d93c2a687c7b36dd66e70f2a6100fc6343edc8c874496cb2f5bbfec8",
            "77e96a7fd3b25c2245de93232c5bdbd8d25de0f89efb627d5efa5fcdf0d6189ca9c99b260b8c5c8a940c705f58c5835a4c47dc1c4a366fb1a52b75c02b0b803232fcd30da91b19704143bab8aecc3f113f9407ddc4ec88c6000260ca285efe50c5ac2b5ae5df24ce3053d1aec14f264718d1d236537e3509e026242ff0f9f3b2",
            ECB
        );
    }

    #[test]
    fn ecb_decrypt_128() {
        test_decrypt::<AESKey128, ECB>(
            "8ea9b77c27304b37f70e94bc8a0fbf50",
            "0e0c957a80ebda87280ef58214d92f119811acdc3c671ef1e3913f94980a9e146ba895908550ef4234abb7503d436521aba54c7550edc0ef1202759fff90ff19128936814321ee59e111e13e5e482870d58bb44d9cfbfccea78702aad18d4ceea91af0e022431de31bbe8d2745489a35b75734afa2da43817d40e7e8d80d17a2",
            "8679c8d6b2cefa756eeb4874150b3ec65705503de5693adaac256b6fb8703cc41f37aa904fec97e97ea742f09bb70d25ec68a48db1bf52dcaf02387efc3ccc875b58956edcc91cb771cbd3d601ae2bb063d587732bf671af67af349a206510ad2e5a528bbe37ecc9c107a40844d97e2a2ecd36721d4a97564cce417c6ee4076c",
            ECB
        );
        test_decrypt::<AESKey128, ECB>(
            "6cd4460b0055c521a3fa4329bd718db4",
            "6d8f021c13f1e2b0e7268b09d55e958d256e200a4e5de6eecbf8dc0ae65b35ae3faa1a5ac78fe2df68f99ebf27ecee3cdd29f9cccf2de169062dbcec55c8ee69cdabddbccf3f4428c9b31b61df09db783833d1eb75594ed2cbdf3a3906a831665447dd11f7c54759a48266adfbd78954f0071de0f8422d94f6fb43091b986f58",
            "a66e6fc2d52b004dc347e969d96aabcdac09f7b54b081f2b9a63b04320d75d4f084cd4a6523a55ddd5a10e63bf43d5c65caa6c6114626e8bf126e303c1fea367df37f1304799a6194502903b36673e801b0ce3559a27fc2922d0ffe25fde849bf5ee81d2bd39a0bb3f055e86cb55ad956efda812baaf004ff84928f16f17901f",
            ECB
        );
        test_decrypt::<AESKey128, ECB>(
            "bac9506f9bfb821d62e69330410bb56f",
            "0085ecce89afb8f0bdbcab325d6e11f2aaeb549f50a9d91fb8e64c814faa685367b24b8d20316baaf061adbfe72c9d914d678cd5004d49356ec9949ba752777171ac368279cbe6f5cbbc2ba8154883a9a29e5517d1f3c03cac4f39ce3225060b3efb799cd9c412746ae2a19331b7b2627e663e25a7b001e4c0dcc5e21bc76c38",
            "2928a132349f67d85a6193dba62c9c8fb9c020570c5bbfa49bbc1c14cb6195a24ab29ea07f579240f2c78343c356b1eb3ac1827a7d9fb5cbe39c7140d46e6030269eeb13b7249907eb8e50b35a8d1bb3b3269893e851460c0b443e3ef6823838f4e65cd65c85cf614b50676c47f7232e3f8cfa0c3913196216a2f272837ba541",
            ECB
        );
    }

    #[test]
    fn ecb_encrypt_192() {
        test_encrypt::<AESKey192, ECB>(
            "2dcdf5b284760c8e3fead91f7422cd76aa87fc8f9851f3c1",
            "e4719cd0b8e4816dd4e88c72e528bedc797342c03fd7a346c4c7857ca03d467013b6493c455551e48a1423263b62b127b436106a68548a776a0f34d56b63e7c595f2b205dbe1c393617a01f15a4cc063dae4f4d56b89bfbc8bcc9ae5387c38456f7c076356abadcc67b92ad777eb20fb9f8806e8649790a90615a46d22dd762e",
            "93ff165bbd9d8131ad6cd4f82438477400a7e4d362a0952c65f334f0bb989f49289253644d842ba0a6a1f5eac539abb2ccf314346e7041cfa7c826afc78e10d969770e8fe88ed3817fb4647bab0fce19c759b95305c4b3dbca219849d2c4ac47437c4a2b24add04fd839fe40a2d37b9466fe802d4e824a9194a828933531b538",
            ECB
        );
        test_encrypt::<AESKey192, ECB>(
            "0c42615336745356c2e16147c0f3d46b40d5147804bf8a0d",
            "fff35939a611c7f5a60ac107f33f33d6059f273d2079ab1d90f23777b341c45e2a9b9bf6bfb71dc7d129f64f1b9406ed4f93ade8f56065f1b7321397b0d4a03e1ab2c54dd9af99ce1ecbfb90c80a58886da95e1181a55703d96bd27d1b6ef55ca2e4d475b5276f2dbb85f7a6459dceeb89c67b776fd3bb974452da3ed4ef1647",
            "a138aaf65f76685383f0721f2d51576e63e35a69cafa2f2e003dfb86faa5446c82c7ff33f28212ad0f92d0139b51e59830a23e37065f14471156323005bf4a9f03b984b3b9c221c9f417fba98b01f434c2622ff4107897688309c29e4cf1452c8d92e72220cb00c846a5a8988274d5360d00ab1eb5f94684c7aae3d6dc9ef62b",
            ECB
        );
        test_encrypt::<AESKey192, ECB>(
            "e1733ec076919cab6156077ed9532e7c365acc425747e198",
            "b3e1468e0284f230153db8687d8ec23db079a5b67d72ca04174b3867b13e4ea9945e798d87586cffbe8c545ab374454e403b1eb831501ebe89f3c3b02f3137bd7b46b996fac2869848fb19d5314b3a5c2d4d03b58820460bf90d8d4ab2f120a3dec07d1adf039248787a70572ff70d40f0dc7a1dd210667d1293a1af0d2626cf",
            "b2491ac2c78c31ea40c7bd5dd2c2571e8ad389b104780a87fa21e511eac6c34e91e1e8d27c13d5c442e533ef3410c3fabe53cac4bc73771e4611ecd531e161263bd540edc3dcf055a5234a9e8737629fe78dec494182787f57b8a742bb70141d79e4975c23cdd309c7e6efd8f010e688867018d8b102c264fffb3dd9adb65f5e",
            ECB
        );
    }

    #[test]
    fn ecb_decrypt_192() {
        test_decrypt::<AESKey192, ECB>(
            "90f24d15fe3f1e8ec36a9b98ca9e39c6856173e8714cdc96",
            "fd6d4e919e0f9cf5bd19f2c335a03643a914283d2c8d1328006873b098784a083b49b448b3dc7412af3bec43c9caa096a9cdef326c1d8b39a526e844d324120f2aca4e98bfd391eb49701f77b04db367f145808a7e7014990ae36ebc529a4006173af6acd6dc9396f305ffc3acd244930ac3c12c7884a671ea472eff956fa2d0",
            "60a19923e2211633c029142a298714ced9fbe3e2344d379c1a173e2e9a184de90713d81e201cbf37fe5437c60d843832190024e13e65868b10b0d272702ff1ca65d09358d8b3785256cc842b6d4808596a5b654e427f8b43efb306b1468a2aa32cf00db53e339bfdf1782712a5e533e492ceb4e0900c9df5e187a93e87b53891",
            ECB
        );
        test_decrypt::<AESKey192, ECB>(
            "7df8177859685552ab1adb295469b17e49a9f166d0c28c09",
            "74165040521df8c567dd83d3fc00a8de8a76690d30845c9fc17fa071c20d34448c21ed4970e1b27c1f07f9a19bcc3db5284f8d038d681739fed7e91d76f21ea5d5277feeb74a82b4456ad57bfa783e748d256230eb9982bfe122dd1146c5cada6a57efc98144d20048b94cd69694ffa87ddd2672897b58558dc38b6074ee52de",
            "be8eb554de5c98cdf56f360b84fc22ca4d6cafbdd4a3b92d2d7e57aca37b96f2511be53d2b09cfd7e6eb65a22e84d3b33701428decfd7b607c974f8de1976e2ab60224850c44fe171ecfe7eb0760e94bdd2ef13504480498ee97db74cb167b7c7f21d375ce37a8774acdaa3058c438c32caafaff3cc4ffaf4a426cecfabb5f9a",
            ECB
        );
        test_decrypt::<AESKey192, ECB>(
            "30fbb23d92623bdbc6690b51be79b4e9cf6162fda9cad2a6",
            "fb267ef6092080f79754de19dfd8701986e97403b82468dea7f8271378c8f843569fb165a614da54daacdb8861f451a0b7e3c27cdf8a099e113ca1afeb49ff3abf176ffa19c2a2b4df19712ab14ce7070b53cb0e4b5b5f6e253e876990aeca2e2b2c149cde619eae3d7fe995243b76a3417541aa02e6cd77e649ad8b281271f1",
            "7bdc5b3f311b6dc8e1618bdc81c4995ada7220d3dfa858621fbcdde90bc7cbc81377dde7e46112323ffa8a34d6e565d0fe9b1ce8a8aafdd9662d4bc2a194aef98ee5526f2ad1d8df255fd6d71c17ea46d646a2154d98d8d77bfddf4a55f255b99aed1de0d1434ae5fc34ad23afec54593d783f2882aa96fbb84c4a45d12428ac",
            ECB
        );
    }

    #[test]
    fn ecb_encrypt_256() {
        test_encrypt::<AESKey256, ECB>(
            "58fc964ca3f66cb04074d84d32ff62da7b1b3c61925b934bfeb34b05fad4a865",
            "460290ddafc7bef90ce99bbe7fd5e7e749c6cc3a9bcd5a38a2309e40adc1b8c4a8aed623a018e7a0a50a4fc97008945dbb2117e84b53bf6a2c3321c98ae0f85d8780e945d42a41e9d3f17bf7ce4bbfde56cd1d77f61324c1f739dcadb9acfa65f7d8cd8e5d17ca650343891f745eacbfac439561d2a3f05f1bac3b78069ee2f1",
            "4be8f272f1f20634b363a15515a73c54cf0cf1c710be88bb75b2eb979b138b35c4fe611f066502a72b0780d419b4c720f8f8e1ebf297064e7899b4489c1918d3b3f44c7c0b4929a756b54c651ef4e04adbe908015aba6749bc6ca0c00e964253c57d1c885bce2eb164918e8410d05d4788692411fe2e48314795810617200933",
            ECB
        );
        test_encrypt::<AESKey256, ECB>(
            "8f53ea9c38a510a2d276e8b34da6681d230bf2094dfe7e1d183ce3892263745e",
            "abf3beb2f28a6b96beba27e26aa719d57d9d68f0f34708b05e377171f33cda5c19fbaf5e8be6faa55b0f654630f71ff2d9d27417a936a4a398f8050cc9553efd20c9903411d4c38d359637d0de3b54c625c9e6980046dbfb25fc218a40cc2c1ca9dd0621035bcac93c9652042c430d20bd6b861dbe107972c75c83971b738038",
            "55009a7d054a2744541ccecf4f6c7075cdf162e64b45118db73c81e7c50a68fdfc8fd4a47d1b1efa8511f2d8683f38b79b2a87cf00e5f82908ce079afb60d90d92d237ec755c82ea70707bbc8eacb8661aba61dac5ac74c88553a8750f44317547ea5442f6bbe6947a183df813dc82a0f029cbd3753b54258a7d0fc47701d147",
            ECB
        );
        test_encrypt::<AESKey256, ECB>(
            "f29d0bbac8e8dda8854d75a4f6070fff7ad8666daf1b7db6e87112e614529b25",
            "1020469fa2958cb65361fe98874b74819a6e19cbb31ddaa7a6e0c48db8dd376e73e33a6956d374666aba18506d50aa415ff427afec791117d415176e18bebd5fcf218e0f96f48f8f54ab1f695adfaaf0c06cdeeab80df749994f5a1a93813627a87b39d81b59d88e5e1dc3479239ce6dd88ff9c4d19f9daca48e069beda8d4b1",
            "c7c3a4b2f1eed5eb66ef4cfdef2d245f0c0358d273677ca922792283d6bb641cba8b66a573c9cfec1c6a8986b3149daeb6983e2a898a25f23b15f5b35b85b0bc0169dab60385c727de637273434c11c3d3426b731ad3332cddb51edd87696d6b44b6c0c748f7135a1ccc7d914c32fe4a60a87bef1d73c2ad805d64e1974734b2",
            ECB
        );
    }

    #[test]
    fn ecb_decrypt_256() {
        test_decrypt::<AESKey256, ECB>(
            "44072e45b3c34feb5659012ede2490a8661124bda2f80717bf8737606b745728",
            "5e4fb853c6f1919815e20d2728c19e0cac144571a96c7c9b716a4537c1831d586e1c48adad977c86aa4e0b3865fc990e01344df236c423c3414a531e017fbf6e2c216188b43a808fd5abce5a1265dcbd0a6f0475eb13dc50936d9267b5a36a4a1d6705f7532bcdf29e75d4b0eb5c166fd81b3e6f9666861465de4fbe563855c7",
            "9e63b433762f9306b71f994c08d3afef2fa6d462dc83268d24dab93efe23cea8afed0fa1b3e1780616f6f00fc45bc0e055973b4fbc6a9b392bded620b2b5b7e844de506d851fa92f905db0588261fad46ffc69cfe014d9739f806dc106b37bdbd97636eed8333c487075e3041011ffe504484206e2acba179f86b7679fe2ec52",
            ECB
        );
        test_decrypt::<AESKey256, ECB>(
            "2b1382a21d878231e7c65959baf5d1a5d0253c1a2541322c9a27c2c2a7132df3",
            "c5a07e76c190c29472aeece190a4a2fc9f52ddf8a0502670117871a14dcb46970e5a81124f7673090e5ed44913a5ddfada179d98816276948df4cabde50a73e8cf92a630529a798026f50f731acfe6d657fbb61581a52c0a3fb570fd7086859c285d5fea486368c656ad990dcaa1a5551054188ead624840b9daa8f6e89adf26",
            "6a17410e60e4c3b81d1ccda6e90106320f017ef7313dccb5b9a0979a6bda57fad7aafc69460489084b02c711af75fb1c252810ce170e554f46cbd049c5144eb2ffd77a83f49b3d29d7713291ea63bdf1e59f29530a0afe92e69bef4263f25ff2ec16bab9a5dcb813fe87b97bcbd69be01a7de95bca876e1b8e640ce2ab3d0e18",
            ECB
        );
        test_decrypt::<AESKey256, ECB>(
            "551495a924ea594ff7a7b2a9642198b5f0154f8f60a4ca54d020abb3d4f2bdff",
            "afe98617a5ab6c825c045c4f2ef33657f2c47c3139ff2327134bd8c91981c58ad5bde28609a956e0c49e21986027292ed4b1c59fcfe72ab8700b695dadb83cf8719c48c0bfc8723b883d4ff7cfc878e7d5315eadf292fc7076c448c76180876bf729d133cd9a23df400da47bdf5f8def1ab6d884d91f4815c3294573e78325d4",
            "504d46ad5e54d918f9f46a2dbd2325a209bd96889d62692314a677d1d2184bbb5261a44c0fdadaad9658ccc5a50afbcfe0bacaf1bfc2a375b7ad3e24b3221126adc736bbe1038b601433de4515fe0407c2b96a6235a00742806bd58bc5b48f218053396a67cb407f88b0e7c1e01880a5261bb547d77d1e1d6eb1cf1d6c49ee57",
            ECB
        );
    }
}